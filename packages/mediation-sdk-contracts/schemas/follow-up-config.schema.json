{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://ai-network.local/schemas/follow-up-config.schema.json",
  "title": "FollowUpChainConfig",
  "type": "object",
  "required": ["enabled", "generatorPolicy", "suggestionCount", "sponsored"],
  "properties": {
    "enabled": { "type": "boolean" },
    "generatorPolicy": {
      "type": "string",
      "enum": ["model", "rules", "hybrid"]
    },
    "suggestionCount": { "type": "integer", "minimum": 1, "maximum": 8 },
    "minSuggestionLength": { "type": "integer", "minimum": 1, "maximum": 200 },
    "maxSuggestionLength": { "type": "integer", "minimum": 1, "maximum": 200 },
    "dedupeBySemantic": { "type": "boolean" },
    "sponsored": {
      "type": "object",
      "required": ["enabled", "maxSlots", "label", "placement"],
      "properties": {
        "enabled": { "type": "boolean" },
        "maxSlots": { "type": "integer", "minimum": 0, "maximum": 3 },
        "label": { "type": "string", "minLength": 1 },
        "placement": {
          "type": "string",
          "enum": ["top", "bottom", "mixed"]
        },
        "minRelevanceScore": { "type": "number", "minimum": 0, "maximum": 1 }
      },
      "additionalProperties": false
    },
    "safety": {
      "type": "object",
      "properties": {
        "blockedCategories": {
          "type": "array",
          "items": { "type": "string" }
        },
        "blockedKeywords": {
          "type": "array",
          "items": { "type": "string" }
        }
      },
      "additionalProperties": false
    },
    "frequencyCap": {
      "type": "object",
      "properties": {
        "maxSponsoredFollowUpPerSession": { "type": "integer", "minimum": 0 },
        "maxSponsoredFollowUpPerUserPerDay": { "type": "integer", "minimum": 0 }
      },
      "additionalProperties": false
    },
    "observability": {
      "type": "object",
      "properties": {
        "emitChainEvents": { "type": "boolean" },
        "sampleRate": { "type": "number", "minimum": 0, "maximum": 1 }
      },
      "additionalProperties": false
    }
  },
  "additionalProperties": false
}
